<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>è™šæ‹Ÿå® ç‰©çºªå¿µé¦† - å’ªå’ªçš„å°çª</title>
    <!-- å¼•å…¥ä¾èµ– -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        /* åŸºç¡€æ ·å¼ */
        body {
            background: #FDF6E3;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        .memorial-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* å® ç‰©æ¡£æ¡ˆåŒº */
        #pet-profile {
            text-align: center;
            border-bottom: 2px dashed #FFB6C1;
            padding-bottom: 20px;
        }

        /* çŒ®èŠ±åŠ¨ç”» */
        .flower-btn {
            background: #FF69B4;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 20px;
        }

        .flower-particle {
            position: absolute;
            pointer-events: none;
            animation: fall 2s linear;
        }

        @keyframes fall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        /* çºªå¿µç¯æ•ˆæœ */
        .candle {
            width: 20px;
            height: 40px;
            background: #FFF;
            position: relative;
            display: inline-block;
            margin: 5px;
        }

        .flame {
            width: 10px;
            height: 15px;
            background: #FFA500;
            border-radius: 50% 50% 50% 50%;
            position: absolute;
            top: -10px;
            left: 5px;
            animation: flicker 0.1s infinite;
        }

        @keyframes flicker {
            0% { transform: skew(1deg, 0); }
            50% { transform: skew(-1deg, 1deg); }
            100% { transform: skew(0, -1deg); }
        }
    </style>
</head>
<body>
    <div class="memorial-container">
        <!-- å® ç‰©æ¡£æ¡ˆ -->
        <div id="pet-profile">
            <h1>â¤ï¸ æ°¸è¿œæ€€å¿µå’ªå’ªï¼ˆ2015-2023ï¼‰ â¤ï¸</h1>
            <img src="https://via.placeholder.com/200x200?text=Pet+Photo" alt="å’ªå’ªçš„ç…§ç‰‡" style="border-radius: 50%;">
            <p>ä¸€åªçˆ±æ™’å¤ªé˜³çš„æ©˜çŒ«ï¼Œæœ€çˆ±åƒå°é±¼å¹²å’Œè¿½æ¿€å…‰ç¬”</p>
        </div>

        <!-- çŒ®èŠ±æŒ‰é’® -->
        <div style="text-align: center; margin: 20px 0;">
            <button class="flower-btn" onclick="sendFlower()">ğŸŒ¸ çŒ®èŠ±ï¼ˆå·²çŒ® <span id="flower-count">0</span> æœµï¼‰</button>
        </div>

        <!-- çºªå¿µç¯åŒºåŸŸ -->
        <div id="candle-area" style="text-align: center;"></div>

        <!-- ç•™è¨€æ¿ -->
        <div>
            <h3>ç•™è¨€å¢™</h3>
            <input type="text" id="message-input" placeholder="å†™ä¸‹ä½ çš„æ€€å¿µ...">
            <button onclick="postMessage()">æäº¤</button>
            <div id="message-wall" style="margin-top: 10px;"></div>
        </div>
    </div>

    <script>
        // Firebase åˆå§‹åŒ–ï¼ˆæ›¿æ¢ä¸ºä½ è‡ªå·±çš„é…ç½®ï¼‰
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID",
            databaseURL: "YOUR_DATABASE_URL"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // å®æ—¶æ›´æ–°çŒ®èŠ±æ•°é‡
        database.ref('flowers').on('value', (snapshot) => {
            document.getElementById('flower-count').textContent = snapshot.val() || 0;
        });

        // çŒ®èŠ±åŠŸèƒ½
        function sendFlower() {
            // å¢åŠ çŒ®èŠ±æ•°
            database.ref('flowers').transaction((count) => (count || 0) + 1);
            
            // èŠ±ç“£åŠ¨ç”»
            for (let i = 0; i < 5; i++) {
                const flower = document.createElement('div');
                flower.className = 'flower-particle';
                flower.style.left = Math.random() * 100 + 'vw';
                flower.innerHTML = 'ğŸŒ¸';
                document.body.appendChild(flower);
                setTimeout(() => flower.remove(), 2000);
            }
        }

        // çºªå¿µç¯å®æ—¶åŒæ­¥
        database.ref('candles').on('child_added', (snapshot) => {
            const candle = document.createElement('div');
            candle.className = 'candle';
            candle.innerHTML = '<div class="flame"></div>';
            candle.title = `ç‚¹äº®è€…ï¼š${snapshot.val().user}`;
            document.getElementById('candle-area').appendChild(candle);
        });

        // ç‚¹å‡»ç‚¹äº®èœ¡çƒ›
        document.getElementById('candle-area').onclick = () => {
            const user = prompt('è¯·è¾“å…¥ä½ çš„åå­—ï¼š');
            if (user) {
                database.ref('candles').push().set({ user });
            }
        };

        // ç•™è¨€åŠŸèƒ½
        function postMessage() {
            const message = document.getElementById('message-input').value;
            if (message) {
                database.ref('messages').push().set({
                    text: message,
                    timestamp: firebase.database.ServerValue.TIMESTAMP
                });
                document.getElementById('message-input').value = '';
            }
        }

        // åŠ è½½å†å²ç•™è¨€
        database.ref('messages').on('child_added', (snapshot) => {
            const msg = snapshot.val();
            const div = document.createElement('div');
            div.textContent = `${new Date(msg.timestamp).toLocaleString()}: ${msg.text}`;
            div.style.padding = '5px';
            div.style.borderBottom = '1px solid #eee';
            document.getElementById('message-wall').appendChild(div);
        });
    </script>
</body>
</html>